<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MIHN | طلبات الخدمات</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&display=swap" rel="stylesheet">

<style>
  body {
    font-family: 'Tajawal', sans-serif;
    background-color: #e9e6e2;
    margin: 0;
    padding: 0;
    color: #2d2d2d;
  }

  .site-header {
    background: #d8d5d0;
    border-bottom: 2px solid #b9b6b2;
    padding: 15px 20px;
    text-align: center;
  }
  .logo { width: 120px; }

  main { padding: 40px 20px 80px; }
  h1 { text-align: center; margin-bottom: 35px; font-weight: 700; color: #3e3e3e; }

  .requests { max-width: 850px; margin: 0 auto; display: flex; flex-direction: column; gap: 18px; }

  .request {
    background: #f6f5f3;
    border: 2px solid #c7c5c2;
    border-radius: 14px;
    padding: 20px;
    transition: all 0.3s ease;
    box-shadow: 0 3px 10px rgba(0,0,0,0.04);
    cursor: pointer;
  }
  .request:hover {
    transform: translateY(-3px);
    box-shadow: 0 5px 15px rgba(0,0,0,0.08);
  }
  .request h3 { margin: 0; font-size: 1.15rem; color: #3c3c3c; }

  .details { display: none; color: #5a5a5a; font-size: 15px; margin-top: 10px; }

  .status {
    display: inline-block;
    padding: 5px 12px;
    border-radius: 8px;
    font-weight: 600;
    font-size: 14px;
    margin-top: 10px;
  }
  .pending { background: #fff3cd; color: #856404; }
  .accepted { background: #eaf1ed; color: #4a675a; }
  .rejected { background: #f2dada; color: #8b3f3f; }
  .completed { background: #d1ecf1; color: #0c5460; }

  .site-footer {
    background: #d8d5d0;
    border-top: 2px solid #b9b6b2;
    padding: 15px;
    text-align: center;
    color: #4b4b4b;
    font-size: 15px;
  }
  .footer-email { color: #3e3e3e; text-decoration: none; font-weight: bold; }
  .separator { margin: 0 8px; color: #999; }

  .back-btn {
    display: block;
    width: fit-content;
    margin: 40px auto 0;
    background-color: #3f3f3f;
    color: #fff;
    text-decoration: none;
    padding: 10px 22px;
    border-radius: 10px;
    font-weight: 600;
    font-size: 16px;
    transition: all 0.3s ease;
  }
  .back-btn:hover { background-color: #5a5a5a; transform: translateY(-2px); }
  
  .btn-rate {
    padding: 6px 12px;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-weight: 600;
    color: #fff;
    font-size: 14px;
    background-color: #5a7d68; 
    transition: all 0.25s ease;
    text-decoration: none;
    display: inline-block;
    text-align: center;
    margin-top: 8px;
  }
  .btn-rate:hover {
    background-color: #4a675a;
    transform: scale(1.05);
  }
  .btn-rate.rated {
    background-color: #6c757d;
    cursor: not-allowed;
  }
</style>
</head>

<body>

<header class="site-header">
  <a href="index.html" aria-label="الصفحة الرئيسية">
    <img src="image/logo.jpg" alt="شعار مِهَن" class="logo">
  </a>
</header>

<main>
  <h1>طلبات الخدمات</h1>
  <div class="requests">

    <div class="request">
      <h3>🚗 توصيل الطلبات</h3>
      <div class="status pending">قيد الدراسة | 9:00 ص</div>
      <p class="details">مقدم الخدمة: سعود القحطاني<br>توصيل الطلبات مثل الأطعمة أو المستلزمات المنزلية بسرعة وموثوقية إلى العنوان المطلوب</p>
    </div>

    <div class="request">
      <h3>🧹 تنظيف المنازل</h3>
      <div class="status accepted">مقبول | 3:00 م</div>
      <p class="details">مقدم الخدمة: نوف العتيبي<br>تنظيف شامل للغرف والمطابخ والحمامات، إزالة الغبار والأوساخ اليومية بدقة واحترافية.</p>
    </div>

    <div class="request">
      <h3>🏠 سباكة</h3>
      <div class="status rejected">مرفوض | 5:30 م</div>
      <p class="details">مقدم الخدمة: فيصل السبيعي<br>إصلاح وصيانة الأنابيب، تسليك المجاري، تركيب صنابير ومحابس المياه بكفاءة عالية.</p>
    </div>

    <div class="request">
      <h3>🔧 إصلاح الحواسيب</h3>
      <div class="status accepted">مقبول | 7:00 م</div>
      <p class="details">مقدم الخدمة: أمل الشهراني<br>صيانة الحواسيب المكتبية والمحمولة مع تنظيف الأجهزة من الفيروسات وتحديث النظام.</p>
    </div>

    <div class="request">
      <h3>🚚 المشاوير الشخصية</h3>
      <div class="status pending">قيد الدراسة | 10:15 ص</div>
      <p class="details">مقدم الخدمة: نايف الحربي<br>توفير خدمة نقل شخصية للذهاب من مكان لآخر بسيارة آمنة وموثوقة مع الالتزام بالمواعيد المحددة.</p>
    </div>

    <div class="request">
      <h3>🎉 الضيافة</h3>
      <div class="status accepted">مقبول | 8:00 م</div>
      <p class="details">مقدم الخدمة: شهد المطيري<br>تنظيم واستقبال الضيوف خلال المناسبات والحفلات المنزلية.</p>
    </div>

    <!-- ===== طلبات تحتاج تقييم ===== -->
    <div class="request" data-req-id="7">
      <h3>💇‍♀️ تصفيف الشعر</h3>
      
      <p class="details">مقدم الخدمة: لمى الحارثي<br>تقديم خدمة تصفيف الشعر للنساء مع الالتزام بالمواعيد والجودة العالية.</p>
      <div class="actions">
        <button class="btn-rate" id="rate-btn-7" onclick="rateService(7)">تقييم الخدمة</button>
      </div>
    </div>

    <div class="request" data-req-id="8">
      <h3>🖌️ طلاء الجدران</h3>
      
      <p class="details">مقدم الخدمة: سعود المطيري<br>دهان الجدران الداخلية والخارجية بدقة واحترافية مع استخدام أفضل المواد.</p>
      <div class="actions">
        <button class="btn-rate" id="rate-btn-8" onclick="rateService(8)">تقييم الخدمة</button>
      </div>
    </div>

  </div>

  <a href="services.html" class="back-btn">العودة إلى الصفحة الرئيسية </a>
</main>

<footer class="site-footer">
  <a href="mailto:contact@mihan.sa" class="footer-email">contact@mihan.sa</a>
  <span class="separator">•</span>
  <span>© 2025 مِهَن — جميع الحقوق محفوظة</span>
</footer>

<script>
// Initialize requests data in localStorage if not exists
function initializeRequestsData() {
  let requests = JSON.parse(localStorage.getItem('requests') || '[]');
  
  // Add default requests if empty
  if (requests.length === 0) {
    requests = [
      {
        reqId: 7,
        serviceId: 1,
        title: "تصفيف الشعر",
        provider: "لمى الحارثي",
        date: "2025-10-20",
        time: "2:00 م",
        status: "pending"
      },
      {
        reqId: 8,
        serviceId: 2,
        title: "طلاء الجدران",
        provider: "سعود المطيري",
        date: "2025-10-19",
        time: "10:00 ص",
        status: "pending"
      }
    ];
    localStorage.setItem('requests', JSON.stringify(requests));
  }
}

// Toggle details on click
document.querySelectorAll('.request h3').forEach(heading => {
  heading.addEventListener('click', () => {
    const card = heading.closest('.request');
    card.classList.toggle('active');
    const details = card.querySelector('.details');
    if (details) {
      details.style.display = details.style.display === "block" ? "none" : "block";
    }
  });
});

// Function to navigate to rating page with request ID
function rateService(reqId) {
  window.location.href = `rate.html?reqId=${reqId}`;
}

// Check for completed requests and update their status
function updateRequestsDisplay() {
  initializeRequestsData();
  const requests = JSON.parse(localStorage.getItem('requests') || '[]');
  
  requests.forEach(req => {
    if (req.status === 'completed') {
      const rateButton = document.getElementById(`rate-btn-${req.reqId}`);
      if (rateButton) {
        rateButton.textContent = 'تم التقييم ✓';
        rateButton.classList.add('rated');
        rateButton.onclick = null;
        rateButton.style.pointerEvents = 'none';
      }
      
      const reqElement = document.querySelector(`[data-req-id="${req.reqId}"]`);
      if (reqElement) {
        const statusDiv = reqElement.querySelector('.status');
        if (statusDiv) {
          statusDiv.className = 'status completed';
          statusDiv.textContent = 'مكتمل ومُقيّم';
        }
      }
    }
  });
}

// Run on page load
window.addEventListener('DOMContentLoaded', updateRequestsDisplay);
</script>

</body>
</html>
